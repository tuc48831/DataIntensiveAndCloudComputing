#!/usr/bin/env python
import re
import os
import json
from _collections import defaultdict

cwd = os.getcwd()
path = cwd+"/histoInput/part-00000"
#open file
histoFile = open(path, "r")
#for line in file
for line in histoFile:
    #split line by whitespace
    strings = re.split("\s", line, maxsplit=1)
    #get the file name, split it to the ID and timestamp
    #first is input filename
    #second is json
    header = strings[0]
    info = strings[1]
    
    newJson = json.loads(info)
    newDict = defaultdict(int)
    for key, value in newJson.items():
        #combine fields
        newKey = re.sub("_\d+_", "_", key)
        newDict[newKey] += value
    #replace _42_ in all the key value pairs
    newInfo = re.sub("_\d+_", "_", info)
    
    